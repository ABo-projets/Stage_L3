\documentclass{beamer}

\usetheme{CambridgeUS}
\usecolortheme{seahorse}

\usepackage{geometry}

\usepackage{algorithm2e}
\usepackage{graphicx}
\usepackage{tabularx}
\usepackage{fourier}
\usepackage{hyperref}
\usepackage{multirow}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{amsmath}
\usepackage{float}





	\usepackage{rotating}	%% introduce sideways env
\usepackage{tikz}
\usepackage{amssymb}

%% Public TikZ libraries
\usetikzlibrary{positioning}
\usetikzlibrary{shapes}
\usetikzlibrary{calc,cipher,sponge}


\usetikzlibrary{arrows}			%% Include regular arrows
\usetikzlibrary{arrows.meta}	
%\usepgflibrary{myarrows.new}		%% Include custom arrows
%\usetikzlibrary{mycrypto.symbols}


\tikzset{XOR/.style={draw,
		circle,
		append after command={
			[shorten >=\pgflinewidth, shorten <=\pgflinewidth,]
			(\tikzlastnode.north) edge[] (\tikzlastnode.south)
			(\tikzlastnode.east) edge[] (\tikzlastnode.west)
		},
	},
}

\tikzset{edge/.style={
		-latex new, 
		arrow head=6pt, 
		%						thick
	},
}

\tikzset{line/.style={
		%						thick,
		draw, 
		%						-latex',
		shorten <=1bp,
		shorten >=1bp,
	}
}

\newcommand{\AEheight}{0.75cm}
\newcommand{\AEwidth}{1.5cm}

\tikzset{AE_P/.style={
		rectangle,
		thick,
		draw,
		fill=yellow!20,
		inner sep = 0pt,
		outer sep = 0pt,
		text width=1cm, 
		minimum height=4.5cm,
		text centered,
		%		anchor=north,
	}	
}

\tikzset{AE_vert/.style={
		rectangle,
		thick,
		draw,
		fill=blue!20,
		inner sep = 0pt,
		outer sep = 0pt,
		text width=\AEheight, 
		minimum height=\AEwidth,
		text centered,
		%		anchor=north,
	}
}

\tikzset{AE_msg/.style={
		rectangle,
		thick,
		draw,
		fill=blue!20,
		inner sep = 0pt,
		outer sep = 0pt,
		text width=\AEwidth,
		minimum height=\AEheight,
		text centered,
		%		anchor=north,
	}
}

\tikzset{AE_ctx/.style={
		rectangle,
		thick,
		draw,
		fill=green!20,
		inner sep = 0pt,
		outer sep = 0pt,
		text width=\AEwidth, 
		minimum height=\AEheight,
		text centered,
		%		anchor=north,
	}
}

\tikzset{AE_key/.style={
		rectangle,
		thick,
		draw,
		fill=red!20,
		inner sep = 0pt,
		outer sep = 0pt,
		text width=\AEwidth, 
		minimum height=\AEheight,
		text centered,
		%		anchor=north,
	}
}

\tikzset{AE_tag/.style={
		rectangle,
		thick,
		draw,
		fill=green!20,
		inner sep = 0pt,
		outer sep = 0pt,
		text width=\AEwidth, 
		minimum height=\AEheight,
		text centered,
		%		anchor=north,
	}
}





\usepackage{xcolor}
\usepackage{listings}

\definecolor{mGreen}{rgb}{0,0.6,0}
\definecolor{mGray}{rgb}{0.5,0.5,0.5}
\definecolor{mPurple}{rgb}{0.58,0,0.82}
\definecolor{backgroundColour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{CStyle}{
	backgroundcolor=\color{backgroundColour},   
	commentstyle=\color{mGreen},
	keywordstyle=\color{magenta},
	numberstyle=\tiny\color{mGray},
	stringstyle=\color{mPurple},
	basicstyle=\tiny,
	breakatwhitespace=false,         
	breaklines=true,                 
	captionpos=b,                    
	keepspaces=true,                 
	numbers=left,                    
	numbersep=5pt,                  
	showspaces=false,                
	showstringspaces=false,
	showtabs=false,                  
	tabsize=2,
	language=C
}

\author{Alexane Boldo}

\institute{OCIF, IRISA}

\title{Side-channel attacks on Ascon's S-box}

\date{May-July 2025}

\setbeamertemplate{page number in head/foot}[appendixframenumber]

\begin{document}
	\begin{frame}
		\maketitle\small
		{\centering\itshape Supervisor: Hélène Le Bouder\par}
	\end{frame}
	
	\begin{frame}
		\frametitle{Introduction}
		\textbf{Side-Channel Attacks (SCA):} observation of computation time, power consumption, electromagnetic radiation, ... to discover a secret
		
		$\newline$
		
		\textbf{Goal:} Study the leaks from the winner for lightweight cryptography Ascon to theorize a SCA attack
	\end{frame}
	
%	\AtBeginSection[]
%	{
%		\begin{frame}
%			\frametitle{Table of Contents}
%			\tableofcontents[currentsection]
%		\end{frame}
%	}
	
	\begin{frame}
		\frametitle{Table of Contents}
		\tableofcontents
	\end{frame}
	
	\section{Ascon-AEAD}
	\subsection{Presentation}
	\begin{frame}
		\frametitle{What is Ascon-AEAD?}
		\textbf{Authenticated Encryption with Associated Data (AEAD)}: encrypt, check authentication of content and associated data
		
		\begin{figure}
			\centering
			\input{AEAD}
			\caption{AEAD algorithm from \cite{cours_crypto}}
		\end{figure}
		
	\end{frame}
	
	\begin{frame}
		\frametitle{Ascon's State}
		\begin{tabular}{ccccccccl}
			byte 0&byte 1&byte 2&byte 3&byte 4&byte 5&byte 6&byte 7&\\
			\cline{1-8}
			\multicolumn{8}{|c|}{IV}&$S_0$\\
			\cline{1-8}
			\multicolumn{8}{|c|}{first half of K}&$S_1$\\
			\cline{1-8}
			\multicolumn{8}{|c|}{Second half of K}&$S_2$\\
			\cline{1-8}
			\multicolumn{8}{|c|}{first half of N}&$S_3$\\
			\cline{1-8}
			\multicolumn{8}{|c|}{Second half of N}&$S_4$\\
			\cline{1-8}
		\end{tabular}
	\end{frame}
	
	\subsection{Encryption and decryption phases}
	\begin{frame}
		\frametitle{Encryption and decryption phases}
		
		4 phases: Initialization, Associated data process, plaintext/ciphertext process, Finalization
		
		\begin{figure}
			\centering
			\resizebox{350pt}{80pt}{
				\input{ascon-128}
			}
			\caption{Ascon-AEAD mode, from \cite{cours_crypto}}
		\end{figure}	
	\end{frame}
	
	\subsection{The permutation}
	\begin{frame}
		\frametitle{Ascon's permutation(s)}
		$p = p_L \circ p_S \circ p_C$\\
		
		\begin{columns}[T]
			\column{0.47\textwidth}
			\begin{figure}[h]
				\centering
				\includegraphics[width=0.6\linewidth]{img_files/sbox_computation}
				\caption{S-box computation for the first byte of each word}
				\label{fig:comp}
			\end{figure}
			
			\column{0.47\textwidth}
			\begin{figure}
				\resizebox*{150pt}{90pt}{
				\input{ascon-sbox}
				}
				\caption{Circuit to compute the S-box, from \protect \footnotemark}
				\label{circuit_sbox}
			\end{figure}
			
			\footnotetext{\url{https://extgit.isec.tugraz.at/meichlseder/tikz}}

		\end{columns}
	\end{frame}
	
	\subsection{An analysis of the S-box}
	\begin{frame}
		\frametitle{Table linking the output of the S-box and the key}
		\begin{figure}[h]
			\centering
			\begin{tabular}{|c|c|}
				\hline
				$(n_0^j,n_1^j,IV^j)$&$S_4^j$\\
				\hline\hline
				$(0,0,0)$&$k_0^j$\\
				\hline
				$(0,0,1)$&$0$\\
				\hline
				$(0,1,0)$&$1$\\
				\hline
				$(0,1,1)$&$1 \oplus k_0^j$\\
				\hline
				$(1,0,0)$&$1 \oplus k_0^j$\\
				\hline
				$(1,0,1)$&$1$\\
				\hline
				$(1,1,0)$&$0$\\
				\hline
				$(1,1,1)$&$k_0^j$\\
				\hline
			\end{tabular}
			\caption{Link between $k_0^j$ and $S_4^j$ depending on $IV$ and $N$, from \cite{these}}
			\label{link_k_s4}
		\end{figure}
	\end{frame}
	
	\section{A side-channel attack}
	\subsection{Hardware}
	\begin{frame}
		\frametitle{ChipWhisperer-Lite}
		\begin{figure}[h]
			\raggedright
			\includegraphics[width=0.9\textwidth]{img_files/cwlite_basic1}
			\caption{ChipWhisperer Lite board, from \cite{cwdoc}}
			\label{fig:cw}
		\end{figure}
	\end{frame}
	
	\subsection{CPA attacks}
	\begin{frame}
		\frametitle{Steps for a CPA attack}
		\begin{itemize}
			\item Compute the algorithm multiple times to gain traces
			\item Find model for the consumption
			\item Deduce the hypothesis that correlates best
		\end{itemize}
		\begin{figure}[H]
			\includegraphics[width=0.5\textwidth]{img_files/corr_aes}
			\caption{CPA on another encryption standard}
		\end{figure}
	\end{frame}

	\subsection{Analysis}
	\begin{frame}
		\frametitle{Analyses done}
		\begin{itemize}
			\item{Finding the best model}
				\begin{itemize}
					\item{Vertical vs horizontal}
					\item{HW vs value}
				\end{itemize}
			\item{Attack: finding the vertical output and deduct the key}
		\end{itemize}
	\end{frame}
	
	
	\section{Results}
	\begin{frame}
		\frametitle{Results vertical vs horizontal and HW vs value}
		\begin{columns}[T]
			\column{0.47\textwidth}
			\begin{figure}[h]
				\centering
				\includegraphics[scale=0.25]{img_files/h_and_v_one_byte}
				\caption{Mutual information for the horizontal and the vertical value}
				\label{hvval}
			\end{figure}
			\column{0.47\textwidth}
			\begin{figure}
				\centering
				\includegraphics[scale=0.25]{img_files/vertical_one_bit}
				\caption{Mutual information between power consumption and HW or value}
				\label{vHW}
			\end{figure}
		\end{columns}
	\end{frame}
	
%	\begin{frame}
%		\frametitle{Results distinguisher}
%		\begin{figure}
%			\centering
%			\includegraphics[scale=0.3]{img_files/corr_vs_MI_hHW}
%			\caption{Mutual information and absolute Pearson correlation for a horizontal attack on the reference implementation}
%			\label{corvsMI}
%		\end{figure}
%	\end{frame}
	
	\begin{frame}
		\frametitle{Results attack}
		\begin{figure}[h]
			\centering
			\includegraphics[scale=0.3]{img_files/nonces_alea}
			\caption{Mutual information between the Hamming weight of the outputs and the power consumption, for each of the possible outputs for the first nonce}
			\label{all_alea}
		\end{figure}
	\end{frame}
	
	\section{Conclusion}
	\begin{frame}
		\frametitle{Conclusion}
		\begin{itemize}
			\item Good leaks compared to random values
			\item Though apparent weaknesses, unsuccessful attempts
			\item Not enough randomness with false key hypotheses
			\item Leads to follow: belief propagation
		\end{itemize}
	\end{frame}
	
	
	\appendix
	\bibliographystyle{IEEEtran} 
	\bibliography{IEEEabrv,refs}
	
	\section{Equations for linking the output of the S-box to the key}
	\begin{frame}
		\frametitle{Finding this table (1)}
		\begin{gather*}
			S_4^j = n_o^j \oplus n_1^j \oplus k_0^j \times (1 \oplus IV^j \oplus n_1^j)\\
			S _4^j =\left \{	
			\begin{array}{ll}
				k_0^j \times (1 \oplus IV^j) & if\ (n_0^j,n_1^j)=(0,0)\\
				k_0^j \times IV^j & if\ (n_0^j,n_1^j)=(1,1)\\
				1 \oplus k_0^j \times IV^j & if\ (n_0^j,n_1^j)=(0,1)\\
				1 \oplus k_0^j \times (1 \oplus IV^j) & if\ (n_0^j,n_1^j)=(1,0)\\
			\end{array}
			\right.
		\end{gather*}
	\end{frame}
	
	\begin{frame}
		\frametitle{Finding this table (2)}
		\noindent Then if $IV^j = 0$: 
		$$S _4^j =\left \{	
		\begin{array}{ll}
			k_0^j& if\ (n_0^j,n_1^j)=(0,0)\\
			0& if\ (n_0^j,n_1^j)=(1,1)\\
			1& if\ (n_0^j,n_1^j)=(0,1)\\
			1 \oplus k_0^j& if\ (n_0^j,n_1^j)=(1,0)\\
		\end{array}
		\right.$$
	\end{frame}
	
	\begin{frame}
		\frametitle{Finding this table (3)}
		\noindent Otherwise, if $IV^j = 1$:
		$$S _4^j =\left \{	
		\begin{array}{ll}
			0& if\ (n_0^j,n_1^j)=(0,0)\\
			k_0^j& if\ (n_0^j,n_1^j)=(1,1)\\
			1 \oplus k_0^j& if\ (n_0^j,n_1^j)=(0,1)\\
			1& if\ (n_0^j,n_1^j)=(1,0)\\
		\end{array}
		\right.$$
	\end{frame}
	
	\section{Complementary graphs}
	\begin{frame}
		\frametitle{Complementary graph (1)}
		\begin{figure}[H]
			\centering
			\includegraphics[scale=0.3]{img_files/vertical_one_byte}
			\caption{Mutual information between power consumption and Hamming weight of the concatenation of the first bit of each of the word of $S$ and its value like \ref{vHW} but for random nonces}
			\label{vHW&val}
		\end{figure}
	\end{frame}
	
	\begin{frame}
		\frametitle{Complementary graph (2)}
		\begin{figure}[H]
			\centering
			\includegraphics[scale=0.3]{img_files/HWalea}
			\caption{Mutual information between power consumption and vertical HW or random possible HW}
			\label{HWalea}
		\end{figure}
	\end{frame}
	
	\section{Main code} \lstinputlisting[language=C,style=Cstyle,caption=Implementation for ascon.c]{code_files/ascon.c}
	
	\lstinputlisting[language=C,style=Cstyle,caption=Implementation for ascon.h]{code_files/ascon.h}
	
	\lstinputlisting[language=C,style=Cstyle,caption=Implementation for permutation.c]{code_files/permutation.c}
	
	\lstinputlisting[language=C,style=Cstyle,caption=Implementation for permutation.h]{code_files/permutation.h}
	
	\lstinputlisting[language=C,style=Cstyle,caption=Implementation for main.c]{code_files/main.c}
	
	\lstinputlisting[language=Python,style=Cstyle,caption=Implementation for trace capture for the ChipWhisperer]{code_files/traces_sca.py}
	
	\lstinputlisting[style=CStyle, caption=Analysis in Julia of the traces following the established attack]{code_files/decryption_analysis_cpa.jl}
	

\end{document}